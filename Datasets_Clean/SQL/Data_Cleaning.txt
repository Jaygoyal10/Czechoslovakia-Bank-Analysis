SELECT * FROM ACCOUNT;
SELECT * FROM CARD;
SELECT * FROM CLIENT;
SELECT * FROM DISPOSITION;
SELECT * FROM DISTRICT;
SELECT * FROM LOAN;
SELECT * FROM ORDER_LIST;
SELECT * FROM TRANSACTIONS;


SELECT COUNT(*) FROM ACCOUNT;
SELECT COUNT(*) FROM CARD;
SELECT COUNT(*) FROM CLIENT;
SELECT COUNT(*) FROM DISPOSITION;
SELECT COUNT(*) FROM DISTRICT;
SELECT COUNT(*) FROM LOAN;
SELECT COUNT(*) FROM ORDER_LIST;
SELECT COUNT(*) FROM TRANSACTIONS;

SELECT TO_DATE(TO_VARCHAR(DATE), 'YYMMDD') AS CONVERTED_DATE FROM ACCOUNT;


ALTER TABLE ACCOUNT
ADD COLUMN DATE_NEW DATE;

UPDATE ACCOUNT
SET DATE_NEW = DATEADD(YEAR, 25, TO_DATE(TO_VARCHAR(DATE), 'YYMMDD'));

ALTER TABLE ACCOUNT
DROP COLUMN DATE;

ALTER TABLE ACCOUNT
RENAME COLUMN DATE_NEW TO DATE;


UPDATE ACCOUNT
SET FREQUENCY = CASE
    WHEN FREQUENCY = 'POPLATEK MESICNE' THEN 'MONTHLY ISSUANCE'
    WHEN FREQUENCY = 'POPLATEK TYDNE' THEN 'WEEKLY ISSUANCE'
    WHEN FREQUENCY = 'POPLATEK PO OBRATU' THEN 'ISSUANCE AFTER TRANSACTION'
    ELSE FREQUENCY
END;


ALTER TABLE ACCOUNT
ADD COLUMN Card_Assigned VARCHAR(50);

UPDATE ACCOUNT
SET CARD_ASSIGNED = CASE
    WHEN FREQUENCY = 'MONTHLY ISSUANCE' THEN 'Silver'
    WHEN FREQUENCY = 'WEEKLY ISSUANCE' THEN 'Diamond'
    WHEN FREQUENCY = 'ISSUANCE AFTER TRANSACTION' THEN 'Gold'
    ELSE CARD_ASSIGNED
END;


SELECT * FROM ACCOUNT;
SELECT * FROM CARD;

ALTER TABLE CARD
ADD COLUMN ISSUE_DATE DATE;

UPDATE CARD 
SET ISSUE_DATE = DATEADD(YEAR, 24, TO_DATE(TO_VARCHAR(ISSUED), 'YYMMDD'));

ALTER TABLE CARD
DROP COLUMN ISSUED;

ALTER TABLE CARD
RENAME COLUMN ISSUE_DATE TO ISSUED;


UPDATE CARD 
SET TYPE = CASE 
    WHEN TYPE = 'gold' THEN 'Diamond'
    WHEN TYPE = 'classic' THEN 'Gold'
    WHEN TYPE = 'junior' THEN 'Silver'
    ELSE TYPE
END;


SELECT * FROM LOAN;


ALTER TABLE LOAN
ADD COLUMN DATE_NEW DATE;

UPDATE LOAN 
SET DATE_NEW = DATEADD(YEAR, 24, TO_DATE(TO_VARCHAR(DATE), 'YYMMDD'));

ALTER TABLE LOAN 
DROP COLUMN DATE;

ALTER TABLE LOAN 
RENAME COLUMN DATE_NEW TO DATE;

ALTER TABLE LOAN 
MODIFY COLUMN STATUS VARCHAR(50);

UPDATE LOAN
SET STATUS = CASE
    WHEN STATUS = 'A' THEN 'Contract Finished'
    WHEN STATUS = 'B' THEN 'Loan Not Paid'
    WHEN STATUS = 'C' THEN 'Running Contract'
    WHEN STATUS = 'D' THEN 'Client in Debt.'
    ELSE STATUS
END;

SELECT * FROM LOAN;


SELECT * FROM TRANSACTIONS WHERE BANK IS NULL AND YEAR(DATE) = '2016';
SELECT * FROM TRANSACTIONS WHERE BANK IS NULL AND YEAR(DATE) = '2017';
SELECT * FROM TRANSACTIONS WHERE BANK IS NULL AND YEAR(DATE) = '2018';
SELECT * FROM TRANSACTIONS WHERE BANK IS NULL  AND YEAR(DATE) = '2019';
SELECT * FROM TRANSACTIONS WHERE BANK IS NULL AND YEAR(DATE) = '2020';
SELECT * FROM TRANSACTIONS WHERE BANK IS NULL AND YEAR(DATE) = '2021';

SELECT YEAR(DATE) AS TXN_YEARS, COUNT(*) AS TOT_TXNS 
FROM TRANSACTIONS
GROUP BY 1
ORDER BY 2 DESC;


SELECT YEAR(ISSUED), COUNT(*) AS TOTAL 
FROM CARD
GROUP BY 1
ORDER BY 1;

SELECT * FROM TRANSACTIONS WHERE BANK IS NULL AND YEAR(DATE) = 2022;

